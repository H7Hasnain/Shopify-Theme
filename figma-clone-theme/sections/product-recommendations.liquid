{% liquid
  assign num = section.settings.product_count
  if recommendations.performed and recommendations.products_count > 0
    assign items = recommendations.products
  else
    assign items = product.related_products | default: product.recommendations
  endif
%}

<section class="section section--product-recommendations">
  <div class="container">
    <div class="section__header">
      <h2 class="section__title">{{ section.settings.heading }}</h2>
    </div>
    <div class="grid grid--{{ section.settings.columns }}">
      {% for prod in items limit: num %}
        {% render 'product-card', product: prod %}
      {% endfor %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Product recommendations",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "You may also like" },
    { "type": "range", "id": "columns", "label": "Columns", "min": 2, "max": 4, "step": 1, "default": 4 },
    { "type": "range", "id": "product_count", "label": "Products to show", "min": 2, "max": 12, "step": 1, "default": 4 }
  ]
}
{% endschema %}